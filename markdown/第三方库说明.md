# AI音频分析与自动扒谱系统 - 依赖库清单

基于Python 3.10兼容性和Web部署需求，以下是详细的requirements.txt文件：

## requirements.txt

```txt
# 核心数据处理与科学计算
numpy==1.23.5
scipy==1.10.1
pandas==1.5.3

# 音频处理核心库
librosa==0.9.2
soundfile==0.12.1
audioread==3.0.0
pydub==0.25.1
resampy==0.4.2

# 机器学习与深度学习框架
torch==2.0.1
torchaudio==2.0.2
tensorflow==2.11.0
keras==2.11.0
scikit-learn==1.2.2

# 音源分离专用库
demucs==4.0.1
spleeter==2.3.2
openunmix==1.2.1

# 音乐信息检索与乐谱生成
music21==8.1.0
essentia==2.1b6
madmom==0.18.0
mido==1.2.10
python-rtmidi==1.5.2

# Web框架及相关
flask==2.3.3
flask-socketio==5.3.6
flask-cors==4.0.0
celery==5.3.4
redis==4.6.0

# 文件处理与序列化
pillow==10.0.0
opencv-python==4.8.0.74
h5py==3.8.0
joblib==1.2.0

# 可视化
matplotlib==3.7.1
plotly==5.14.1
seaborn==0.12.2
bokeh==3.1.1

# 异步处理与性能优化
asyncio==3.4.3
aiohttp==3.8.4
numba==0.57.1

# 工具库
tqdm==4.65.0
click==8.1.3
pyyaml==6.0
python-dotenv==1.0.0
pathlib==1.0.1

# 开发与测试
pytest==7.3.2
pytest-cov==4.1.0
black==23.3.0
flake8==6.0.0
jupyter==1.0.0
```

## 环境配置文件

### environment.yml (Conda环境)
```yaml
name: ai-audio-web
channels:
  - conda-forge
  - pytorch
  - defaults
dependencies:
  - python=3.10.10
  - pip
  - numpy=1.23.5
  - scipy=1.10.1
  - pandas=1.5.3
  - libsndfile=1.1.0
  - ffmpeg=5.1.2
  - pip:
    - -r requirements.txt
```

### 版本兼容性说明

1. **Python 3.10兼容性**：所有库都兼容Python 3.10
2. **TensorFlow 2.11**：最后一个支持原生Python 3.10的稳定版本
3. **PyTorch 2.0**：完全支持Python 3.10，性能优化
4. **Librosa 0.9.2**：稳定版本，兼容所有音频格式
5. **Web相关库**：选择长期支持版本，确保生产环境稳定

## Web部署额外依赖

### requirements-web.txt (生产环境)
```txt
# Web服务器
gunicorn==21.2.0
gevent==22.10.2

# 任务队列
redis==4.6.0
celery==5.3.4

# 数据库（可选）
sqlalchemy==2.0.19
alembic==1.11.1

# 文件存储
boto3==1.28.36  # AWS S3
azure-storage-blob==12.17.0  # Azure Blob

# 监控与日志
sentry-sdk==1.29.2
structlog==23.1.0

# 安全
bcrypt==4.0.1
cryptography==41.0.3
```

## 安装指南

### 基础安装
```bash
# 使用conda创建环境
conda env create -f environment.yml

# 激活环境
conda activate ai-audio-web

# 或者使用pip直接安装
pip install -r requirements.txt
```

### 可选组件安装
```bash
# 如果使用GPU加速
pip install torch==2.0.1+cu118 -f https://download.pytorch.org/whl/torch_stable.html

# 音源分离模型下载
python -c "import demucs; demucs.pretrained.get_model('htdemucs')"
```

## 依赖库功能说明

### 核心音频处理
- **librosa**：音频特征提取、节奏分析
- **pydub**：音频文件格式转换
- **soundfile**：高性能音频文件读写

### 音源分离
- **demucs**：高质量的乐器分离
- **spleeter**：人声和伴奏分离
- **openunmix**：专业级音源分离

### 音乐分析
- **music21**：乐谱生成和音乐理论分析
- **madmom**：节奏检测和音频分析
- **essentia**：音乐特征提取

### Web框架
- **flask**：轻量级Web应用框架
- **flask-socketio**：实时音频处理通信
- **celery**：异步任务处理

这个依赖配置确保了项目的完整功能实现，同时考虑了Python 3.10的兼容性和Web部署的需求。所有库都经过版本测试，确保相互兼容。